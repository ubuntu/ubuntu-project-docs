(how-to-sponsor-an-upload)=
# How to sponsor an upload

{term}`Ubuntu sponsors` and {term}`Ubuntu security sponsors` have the right to sponsor patches or new packages. If you are interested in {ref}`sponsoring <sponsorship>`, and have gained upload rights, apply to join these teams. See {ref}`path-to-upload-rights` for details on how to apply for upload rights.


(sponsor-a-package)=
## Sponsor a package

This is similar to uploading your own `.changes` file, except that after ensuring that the upload follows all quality standards (see {ref}`how-to-review-a-merge-proposal`), you sign the content of the proposing person with your key and upload it to the Ubuntu Archive instead of a PPA.

:::{note}
These instructions assume the request for sponsorship is in the form of a {term}`merge proposal`. See *How can I convert a debdiff contribution into a git-ubuntu branch?* under {external+git-ubuntu:doc}`howto/patch-pilot` for guidance on working with a 'traditional' contribution in the form of a patch generated by the {manpage}`debdiff(1)` tool.
:::

1. Clone the package repository and change to the created directory:

    ```none
    $ git ubuntu clone <package>
    $ cd <package>
    ```

1. Add the Launchpad ID for which you're sponsoring as a Git `remote`:

    ```none
    $ git ubuntu remote add <sponsoree_LP_user>
    ```

1. Switch to the merge-proposal branch:

    ```none
    $ git checkout "<sponsoree_LP_user>/<MP_branch_name>" -b "<MP_branch_name>"
    ```

1. Generate the `orig` tarballs for the source package:

    ```none
    $ git ubuntu export-orig
    ```

   If this is for a {term}`merge`, add the `--for-merge` flag:

    ```none
    $ git ubuntu export-orig --for-merge
    ```

1. Push the branch to your Launchpad namespace:

    ```none
    $ upload_args=$(git ubuntu prepare-upload args)
    ```

   This command generates arguments for the build step to include the appropriate header reference to the rich history in the {file}`.changes` file and stores the output in the `upload_args` variable.

1. Build the source package (with arguments generated in the previous step -- and stored in the `upload_args` variable -- appended to the command):

    ```none
    $ debuild --build=source --no-check-builddeps \
              --unsigned-changes --unsigned-source \
              ${upload_args}
    ```

   The same command with short options:

    ```none
    $ debuild -S -d -uc -us ${upload_args}
    ```

   :::{note}
   Use your preferred build method ({command}`debuild`, {command}`sbuild`, {command}`dpkg-buildpackage`), but always append `${upload_args}`.
   :::

1. Sign the {file}`.changes` file:

    ```none
    $ cd ..
    $ debsign -k$DEBSIGN_KEYID <package>_<version>_source.changes
    ```

1. Upload the package:

    ```none
    $ dput ubuntu <package>_<version>_source.changes
    ```

:::{admonition} `$DEBSIGN_KEYID` and `$DEB_SIGN_KEYID`
The {command}`debsign` and {command}`dpkg-buildpackage` tools use similar variable names for GPG keys. Do not confuse them:

| tool                         | variable          | manual page                     |
| ---                          | ---               | ---                             |
| {command}`debsign`           | `$DEBSIGN_KEYID`  | {manpage}`debsign(1)`           |
| {command}`dpkg-buildpackage` | `$DEB_SIGN_KEYID` | {manpage}`dpkg-buildpackage(1)` |
:::

## Further reading

* {external+git-ubuntu:doc}`index`
